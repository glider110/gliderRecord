# 工作记录：

> **引言：避免冗余及目标不明确的工作，==复盘追溯==，有据可依。**
>
> ​          **人啊，别太相信自己的记忆力                     ——张启灿**

### 1.工作安排(10.30号更改)：

- `完成障碍物检测的主体功能，三类检测性能稳定。(11.13)`

- `物体识别障碍物日程安排、调研、基本概念。（11.25）`

### 2.日程安排

| 日期：        | 计划：                                                       | 完成情况：                             | 备注： |
| ------------- | ------------------------------------------------------------ | -------------------------------------- | :----- |
| 10.10（Sta）  | 1.时间安排框架建立。2.总结栅格化的相关内容。3.整合前几天的各个模块及避障整体构建。 |                                        |        |
| 10.11（Sun）  | 1.斜坡检测逻辑设计及主体功能实现。                           | 实现障碍检测功能，接入主程序实时测试。 |        |
| 10.12（Mon）  | 1.IdentifySlope接口实时测试。                                |                                        |        |
| 10.13  (Tue)  | 测试不同场景的slop数据，验证分割情况。                       |                                        |        |
| 10.14  (wed)  | 1.梳理计划表。2.算法流程图完善。3.继续测试前天斜面数据。     |                                        |        |
| 10.15  (Thu)  | 1.slam概论。2.pcl处理几何特征。                              |                                        |        |
| 10.16  (Fri)  | 1.加入障碍物检测的模块。                                     | 3D点云特征描述、engine库了解           |        |
| 10.19  (Mon)  | 算法思路变为栅格化点云处理，封装栅格类。                     | 均值、标准差、索引、点云映射完成       |        |
| 10.20  (Tue)  | 余下斜率，及障碍物判定逻辑。                                 | 斜率映射完成                           |        |
| 10.21（Wed）  | std_angle局部特征融合，find位置索引功能实现                  |                                        |        |
| 10.22 （Thu） | 门槛、斜坡、普通障碍物功能基本实现。                         |                                        |        |
| 10.23   (Fri) | 封装前方障碍物识别模块接口，移植到主程序，初步测试效果。     | bug：类变量不能被类函数赋值（10h）     |        |
| 10.26（Mon）  | 移植到笔记本，实时测试识别效果。                             |                                        |        |
| 10.27  (Tue)  | 解决Bug：重复读图，边缘线一直后移情况。                      | bug：Pointindices指针没有clear(8h)     |        |
| 10.28  (wed)  | 实时检测三类型效果，记录总结chw调试技巧。                    | 调试技巧：未完成                       |        |
| 10.29  (Thu)  | 修改判定障碍物三类型的逻辑，测试效果。                       | 基本没做(PPT/开会/c++记录)             |        |
| 10.30  (Fri)  | 修改判定障碍物三类型的逻辑，测试效果。                       | 参数把握及补完chw调试技巧              |        |
|               |                                                              |                                        |        |



### 3.项目记录

1.扫地机器人软件部分包括：避障 识别 建图  导航 。<!--发生的发生-->

2.目前主要工作提供障碍物接口（识别还办不到），辅助激光雷达建立栅格图。

3.硬件方面：激光-视觉融合建图导航（激光雷达+3D相机）>>视觉建图导航（纯3D相机）

4.功能扩展方面：物体识别需要高分辨率的彩色相机，如果利用黑白散斑图是不行的，并且挡住投射器后得到的红外图像亮度也不够，所以产品上面会多加一个RGB相机。

5.合作关系：muxin：提供数据源，物体识别()？ 华南理工：写清扫逻辑路径规划,给地图信息给地图信息 sliver：硬件(PCB/结构)

6.开发板：好一点的用高通的芯片（3326四核、3308两核）一般RAM 256M，芯片商顺便提供配套系统，嵌入式工程师对其做驱动开发，设计好电路 （贴片）在PCB上安装cpu、电容、电阻。

7.在arm版编译项目还有些工作，虽然都是基于linux的系统，但是基于不同的架构，编译工具选取arm_linux_gcc，pcl的编译安装的各种依赖都需要编译。//10.13

8.斜面点云数据问题：为什么深度图很好看，点云图看着很空洞？----尺度缩放因子，深度图拉成一条重合的线，把相邻的两点像素z轴拉长会出现稀疏现象，点云会出现空洞现象，且随着斜率增大效果越明显。//10.13

9.结构光点云常见问题：环境——光强 待测物——==陡变区域、阴影区域、高==反低反   木心相机的前方数据(600mm)地面缺失，不同的地面物质会导致缺失的数据不同，光强影响较为严重。//10.14

10.直接栅格化类提取局部特征来判定物体类别，不经过pcl的大部分算法，其次是等间隔提取，远处数据用少量数据来表征。//10.19

11.std::vector<int> v{0, 1, 2, 3, 4};//10.21 备注：又忘记记录，没理解当初的初衷

12.台阶识别思路:获取点云cloud0，截取地面高于台阶以下的数据数据cloud1，提取平面点云cloud_plane，计算平面高度值y，用cloud1-cloud_plane的到余下的点云cloud3，此点云包含了所求的台阶位置点云和旁边障碍物接壤导致产生的点云，如果要去掉点云cloud_obstacle,则需要求cloud1截取高度为y以上的数据得到孤立的点云cloud4，利用kd搜索范围类的点云并去除。得到前沿台阶点云数据。//10.21

13.任何一副点云都可求他的一个边界，而所需的边界需要筛选，要明白边界产生的调节。1.障碍物接壤产生。2.相机fov导致的。//10.21

14.点云数据的右手法则，木星的y坐标是向下，管理y轴是绿色。

15.测试的时候先检测近距离平行的障碍物→任意障碍物→门槛→斜坡。思想是：简化处理，减少其他条件因素对单一效果的影响，把现状吃透再扩展理解，之前自己老是再这方面折腾，...谨记！//10.29

16.（本质）我们看的深度图是投影在成像面(xoy)上，伪彩色颜色代表距相机平面的远近；而栅格化是投影到地面(相当于xoz)上，前方障碍物即用高度y来衡量。联想木星演示场景，点取y值是取地平面到相机距离。



### 4.一些常用的数据

1.muxin数据：x(-400,400) y(-200,100) z(100,1000) ftp:15 

2.相机安装高度：y=50mm-70mm      机器人宽度：320mm

3.木星最佳测试距离200mm？

